---
title: MySQL50-4-ç¬¬6-10é¢˜
top: false
cover: false
toc: true
mathjax: true
copyright: true
date: 2020-11-07 14:44:10
password:
summary:
tags:
  - MySQL
  - æ•°æ®åº“
  - äº’è”ç½‘
categories:
  - MySQL
  - 50é¢˜
---


### MySQL50-4-ç¬¬6-10é¢˜

æœ¬æ–‡ä¸­ä»‹ç»çš„æ˜¯ç¬¬6-10é¢˜ï¼Œæ¶‰åŠåˆ°çš„ä¸»è¦çŸ¥è¯†ç‚¹ï¼š

- æ¨¡ç³ŠåŒ¹é…å’Œé€šé…ç¬¦ä½¿ç”¨
- è¡¨çš„è‡ªè¿æ¥
- in/not in
- è¿æ¥æŸ¥è¯¢çš„æ¡ä»¶ç­›é€‰

![](https://tva1.sinaimg.cn/large/0081Kckwgy1gkgmq9quckj31d20gu0wv.jpg)
<!--MORE-->



### é¢˜ç›®6

#### é¢˜ç›®éœ€æ±‚

æŸ¥è¯¢â€œæâ€å§“è€å¸ˆçš„æ•°é‡

#### åˆ†æè¿‡ç¨‹

ä½¿ç”¨é€šé…ç¬¦å’Œlikeæ¥è§£å†³

#### SQLå®ç°

```sql
select count(t_name) from Teacher where t_name like "æ%";   -- é€šé…ç¬¦
```

![](https://tva1.sinaimg.cn/large/0081Kckwgy1gkfy1jqoh1j312g0mi4ew.jpg)

è¿™é¢˜æ€•æ˜¯æœ€ç®€å•çš„å§ğŸ˜­



### é¢˜ç›®7

![](https://tva1.sinaimg.cn/large/0081Kckwgy1gkgmq9quckj31d20gu0wv.jpg)

#### é¢˜ç›®éœ€æ±‚

æŸ¥è¯¢å­¦è¿‡**å¼ ä¸‰è€å¸ˆ**æˆè¯¾çš„åŒå­¦çš„ä¿¡æ¯

#### åˆ†æè¿‡ç¨‹

```python
å¼ ä¸‰è€å¸ˆï¼šCourse--->t_name
è¯¾ç¨‹ï¼šc_id------>Score.c_id------->Student.*
```

#### SQLå®ç°

```sql
-- æ–¹æ³•1ï¼šé€šè¿‡å¼ ä¸‰è€å¸ˆçš„è¯¾ç¨‹çš„å­¦ç”Ÿæ¥æŸ¥æ‰¾ï¼›è‡ªå·±çš„æ–¹æ³•
select * -- 3. é€šè¿‡å­¦å·æ‰¾å‡ºå…¨éƒ¨å­¦ç”Ÿä¿¡æ¯
from Student
where s_id in (
  select s_id    -- 2.é€šè¿‡è¯¾ç¨‹æ‰¾å‡ºå¯¹åº”çš„å­¦å·
  from Score  S
  join Course C
  on S.c_id = C.c_id  -- è¯¾ç¨‹è¡¨å’Œæˆç»©è¡¨
  where C.t_id=(select t_id from Teacher where t_name="å¼ ä¸‰")  -- 1.æŸ¥è¯¢å¼ ä¸‰è€å¸ˆçš„è¯¾ç¨‹
);

-- æ–¹æ³•2ï¼šé€šè¿‡å¼ ä¸‰è€å¸ˆçš„è¯¾ç¨‹æ¥æŸ¥è¯¢
select s1.*
from Student s1
join Score s2
on s1.s_id=s2.s_id
where s2.c_id in (
  select c_id from Course c where t_id=(  -- 1. é€šè¿‡è€å¸ˆæ‰¾å‡ºå…¶å¯¹åº”çš„è¯¾ç¨‹
    select t_id from Teacher t where t_name="å¼ ä¸‰"
  )
)

-- æ–¹æ³•3
select s.* from Teacher t
left join Course c on t.t_id=c.t_id  -- æ•™å¸ˆè¡¨å’Œè¯¾ç¨‹è¡¨
left join Score sc on c.c_id=sc.c_id  -- è¯¾ç¨‹è¡¨å’Œæˆç»©è¡¨
left join Student s on s.s_id=sc.s_id  -- æˆç»©è¡¨å’Œå­¦ç”Ÿä¿¡æ¯è¡¨
where t.t_name='å¼ ä¸‰';
```

è‡ªå·±çš„æ–¹æ³•ï¼š

![](https://tva1.sinaimg.cn/large/0081Kckwgy1gkfyw8cji2j31hu0pmwir.jpg)

æ–¹æ³•2æ¥å®ç°ï¼š

![](https://tva1.sinaimg.cn/large/0081Kckwgy1gkgfe6f95qj319a0rywif.jpg)

æ–¹æ³•3å®ç°ï¼š

![](https://tva1.sinaimg.cn/large/0081Kckwgy1gkglhqi59wj30sq0luqeo.jpg)

### é¢˜ç›®8

#### é¢˜ç›®éœ€æ±‚

æ‰¾å‡ºæ²¡æœ‰å­¦è¿‡å¼ ä¸‰è€å¸ˆè¯¾ç¨‹çš„å­¦ç”Ÿ

#### åˆ†æè¿‡ç¨‹

å’Œä¸Šé¢ğŸ‘†çš„é¢˜ç›®æ˜¯äº’è¡¥çš„ï¼Œè€ƒè™‘å–åæ“ä½œ

#### SQLå®ç°

```sql
select * -- 3. é€šè¿‡å­¦å·æ‰¾å‡ºå…¨éƒ¨å­¦ç”Ÿä¿¡æ¯
from Student
where s_id not in (  -- 2.é€šè¿‡å­¦å·å–åï¼šå­¦å·ä¸åœ¨å¼ ä¸‰è€å¸ˆæˆè¯¾çš„å­¦ç”Ÿçš„å­¦å·ä¸­
  select s_id
  from Score  S
  join Course C
  on S.c_id = C.c_id
  where C.t_id=(select t_id from Teacher where t_name ="å¼ ä¸‰")  -- 1.æŸ¥è¯¢å¼ ä¸‰è€å¸ˆçš„è¯¾ç¨‹
);

-- æ–¹æ³•2ï¼š
select *
from Student s1
where s1.s_id not in (
  select s2.s_id from Student s2 join Score s3 on s2.s_id=s3.s_id where s3.c_id in(
    select c.c_id from Course c join Teacher t on c.t_id=t.t_id where t_name="å¼ ä¸‰"
  )
);

-- æ–¹æ³•3
select s1.*
from Student s1
join Score s2
on s1.s_id=s2.s_id
where s2.c_id not in (
  select c_id from Course c where t_id=(  -- 1. é€šè¿‡è€å¸ˆæ‰¾å‡ºå…¶å¯¹åº”çš„è¯¾ç¨‹
    select t_id from Teacher t where t_name="å¼ ä¸‰"
  )
);
```

![](https://tva1.sinaimg.cn/large/0081Kckwgy1gkfz017sdkj31hw0lsn0o.jpg)

æ–¹æ³•2ï¼š

![](https://tva1.sinaimg.cn/large/0081Kckwgy1gkgflt57luj31fg0im0v6.jpg)

### é¢˜ç›®9

![](https://tva1.sinaimg.cn/large/0081Kckwgy1gkgmq9quckj31d20gu0wv.jpg)

#### é¢˜ç›®éœ€æ±‚

æŸ¥è¯¢å­¦è¿‡ç¼–å·ä¸º01ï¼Œ**å¹¶ä¸”å­¦è¿‡**ç¼–å·ä¸º02è¯¾ç¨‹çš„å­¦ç”Ÿä¿¡æ¯

#### åˆ†æè¿‡ç¨‹

- è¯¾ç¨‹ç¼–å·ï¼š`Scoreâ€”â€”>c_id`ï¼ˆè¯¾ç¨‹ç¼–å·ï¼‰
- å­¦ç”Ÿä¿¡æ¯ï¼š`Studentâ€”â€”>*`ï¼ˆå­¦ç”Ÿä¿¡æ¯ï¼‰

#### SQLå®ç°

```sql
-- è‡ªå·±çš„æ–¹æ³•ï¼šé€šè¿‡è‡ªè¿æ¥å®ç°
select s1.*
from Student s1
where s_id in (
  select s2.s_id from Score s2
  join Score s3
  on s2.s_id=s3.s_id
  where s2.c_id='01' and s3.c_id='02'
);

-- æ–¹æ³•2ï¼šç›´æ¥é€šè¿‡whereè¯­å¥å®ç°
select s1.*
from Student s1, Score s2, Score s3
where s1.s_id=s2.s_id
and s1.s_id=s3.s_id
and s2.c_id=01 and s3.c_id=02;

-- æ–¹æ³•3ï¼šä¸¤ä¸ªå­æŸ¥è¯¢
-- 1. å…ˆæŸ¥å‡ºå­¦å·
select sc1.s_id
from (select * from Score s1 where s1.c_id='01') sc1,
			(select * from Score s1 where s1.c_id='02') sc2
where sc1.s_id=sc2.s_id;

-- 2.æ‰¾å‡ºå­¦ç”Ÿä¿¡æ¯
select *
from Student
where s_id in (select sc1.s_id   -- æŒ‡å®šå­¦å·æ˜¯ç¬¦åˆè¦æ±‚çš„
               from (select * from Score s1 where s1.c_id='01') sc1,
               (select * from Score s1 where s1.c_id='02') sc2
where sc1.s_id=sc2.s_id);
```

1. å…ˆä»Scoreè¡¨ä¸­çœ‹çœ‹å“ªäº›äººæ˜¯æ»¡è¶³è¦æ±‚çš„ï¼š**01-05åŒå­¦æ˜¯æ»¡è¶³çš„**

![](https://tva1.sinaimg.cn/large/0081Kckwgy1gkgfvak2fbj30iw0v6dib.jpg)

é€šè¿‡è‡ªè¿æ¥æŸ¥è¯¢çš„è¯­å¥å¦‚ä¸‹ï¼š

![](https://tva1.sinaimg.cn/large/0081Kckwgy1gkggbtl1qgj30qg0iwq49.jpg)

æŸ¥è¯¢å‡ºå­¦å·åå†åŒ¹é…å‡ºå­¦ç”Ÿä¿¡æ¯ï¼š

![](https://tva1.sinaimg.cn/large/0081Kckwgy1gkggd4ze5bj30s80okdio.jpg)

é€šè¿‡whereè¯­å¥å®ç°ï¼š

![](https://tva1.sinaimg.cn/large/0081Kckwgy1gkggjw0wggj30ua0jyq5e.jpg)

æ–¹æ³•3çš„å®ç°ï¼š

![](https://tva1.sinaimg.cn/large/0081Kckwgy1gkgjv0qrhtj316e0lmjuk.jpg)



### é¢˜ç›®10
![](https://tva1.sinaimg.cn/large/0081Kckwgy1gkgmq9quckj31d20gu0wv.jpg)

#### é¢˜ç›®éœ€æ±‚

æŸ¥è¯¢å­¦è¿‡01è¯¾ç¨‹ï¼Œ**ä½†æ˜¯æ²¡æœ‰å­¦è¿‡02**è¯¾ç¨‹çš„å­¦ç”Ÿä¿¡æ¯ï¼ˆæ³¨æ„å’Œä¸Šé¢ğŸ‘†é¢˜ç›®çš„åŒºåˆ«ï¼‰

#### åˆ†æè¿‡ç¨‹

**ä½¿ç”¨çš„è¡¨å’Œå­—æ®µæ˜¯ç›¸åŒçš„**ï¼š

- è¯¾ç¨‹ç¼–å·ï¼š`Scoreâ€”â€”>c_id`ï¼ˆè¯¾ç¨‹ç¼–å·ï¼‰
- å­¦ç”Ÿä¿¡æ¯ï¼š`Studentâ€”â€”>*`ï¼ˆå­¦ç”Ÿä¿¡æ¯ï¼‰

#### SQLå®ç°

é¦–å…ˆçœ‹çœ‹å“ªäº›åŒå­¦æ˜¯æ»¡è¶³è¦æ±‚çš„ï¼šåªæœ‰06å·åŒå­¦æ˜¯æ»¡è¶³çš„

![](https://tva1.sinaimg.cn/large/0081Kckwgy1gkggl91cb0j30k40wcq57.jpg)

##### é”™è¯¯æ€è·¯1

ç›´æ¥å°†ä¸Šé¢ä¸€é¢˜çš„ç»“æœå…¨éƒ¨æ’å‡ºï¼Œå¯¼è‡´é‚£äº›æ²¡æœ‰å­¦è¿‡01è¯¾ç¨‹çš„å­¦ç”Ÿä¹Ÿå‡ºç°äº†ï¼š07ï¼Œ08

```sql
select s1.*
from Student s1
where s_id not in (   -- ç›´æ¥å°†ä¸Šé¢ä¸€é¢˜çš„ç»“æœå…¨éƒ¨æ’å‡ºï¼Œå¯¼è‡´é‚£äº›æ²¡æœ‰å­¦è¿‡01è¯¾ç¨‹çš„å­¦ç”Ÿä¹Ÿå‡ºç°äº†ï¼š07ï¼Œ08
  select s2.s_id from Score s2
  join Score s3
  on s2.s_id=s3.s_id
  where s2.c_id='01' and s3.c_id ='02'
);
```

![](https://tva1.sinaimg.cn/large/0081Kckwgy1gkggsz5r1kj30pu0l4acc.jpg)

##### é”™è¯¯æ€è·¯2

å°†ä¸Šé¢é¢˜ç›®ä¸­çš„02è¯¾ç¨‹ç›´æ¥å–åï¼Œå¯¼è‡´åŒæ—¶ä¿®è¿‡01ï¼Œ02ï¼Œ03æˆ–è€…åªä¿®01ï¼Œ03çš„åŒå­¦ä¹Ÿä¼šå‡ºç°

```sql
select s1.*
from Student s1
where s_id in (
  select s2.s_id from Score s2
  join Score s3
  on s2.s_id=s3.s_id
  where s2.c_id='01' and s3.c_id !='02'   -- ç›´æ¥å–åæ˜¯ä¸è¡Œçš„ï¼Œå› ä¸ºä¿®æ”¹(01,02,03)çš„åŒå­¦ä¹Ÿä¼šå‡ºç°
);
```

![](https://tva1.sinaimg.cn/large/0081Kckwgy1gkgilmvzi8j31mk0pm78m.jpg)

##### æ­£ç¡®æ€è·¯

https://www.jianshu.com/p/9abffdd334fa

```sql
-- æ–¹æ³•1ï¼šæ ¹æ®ä¸¤ç§ä¿®è¯¾æƒ…å†µæ¥åˆ¤æ–­

select s1.*
from Student s1
where s1.s_id in (select s_id from Score where c_id='01')   -- ä¿®è¿‡01è¯¾ç¨‹ï¼Œè¦ä¿ç•™
and s1.s_id not in (select s_id from Score where c_id='02');  -- å“ªäº›äººä¿®è¿‡02ï¼Œéœ€è¦æ’é™¤
```

![](https://tva1.sinaimg.cn/large/0081Kckwgy1gkgifql6vwj312y0dm0ue.jpg)

![](https://tva1.sinaimg.cn/large/0081Kckwgy1gkgip48kmjj30w50u0jua.jpg)



ï¼ï¼ï¼ï¼ï¼æ–¹æ³•2ï¼šå…ˆæŠŠ06å·å­¦ç”Ÿæ‰¾å‡ºæ¥

```sql
select * from Student where s_id in (
  select s_id
  from Score
  where c_id='01'   -- ä¿®è¿‡01è¯¾ç¨‹çš„å­¦å·
  and s_id not in (select s_id   -- åŒæ—¶å­¦å·ä¸èƒ½åœ¨ä¿®è¿‡02è¯¾ç¨‹ä¸­å‡ºç°
                   from Score
                   where c_id='02')
);
```

![](https://tva1.sinaimg.cn/large/0081Kckwgy1gkgjb043c2j311w0ei0tx.jpg)

![](https://tva1.sinaimg.cn/large/0081Kckwgy1gkgj9yojbmj30s60jeq4v.jpg)

#### å¦‚ä½•Scoreä¸­æ‰¾å‡º06å·å­¦ç”Ÿ

å¦‚ä½•æ‰¾å‡º06å·å­¦ç”ŸğŸ˜ƒ

```sql
select s_id
from Score
where c_id='01'   -- ä¿®è¿‡01è¯¾ç¨‹çš„å­¦å·
and s_id not in (select s_id   -- åŒæ—¶å­¦å·ä¸èƒ½åœ¨ä¿®è¿‡02è¯¾ç¨‹ä¸­å‡ºç°
                 from Score
                 where c_id='02')
```

![](https://tva1.sinaimg.cn/large/0081Kckwgy1gkgl1u6850j314y0fw0um.jpg)

![](https://tva1.sinaimg.cn/large/0081Kckwgy1gkgl5d7jxmj30ws0u0mze.jpg)


